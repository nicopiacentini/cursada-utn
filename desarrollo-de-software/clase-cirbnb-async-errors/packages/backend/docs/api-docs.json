
{
  "openapi": "3.1.1",
  "info": {
    "title": "API de CirBnb",
    "version": "1.0.0",
    "description": "API para gestionar recursos de alojamientos.\nBasado en las rutas definidas en `alojamientoRoutes.js` y la lógica del `AlojamientoController`."
  },
  "paths": {
    "/alojamientos": {
      "get": {
        "summary": "Listar alojamientos paginados",
        "description": "Retorna una lista paginada de alojamientos. Permite filtrar por precio máximo (`maxPrice`).",
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": { "type": "integer", "minimum": 1, "default": 1 },
            "description": "Número de página (1-indexado)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": { "type": "integer", "minimum": 1, "maximum": 100, "default": 10 },
            "description": "Cantidad de elementos por página"
          },
            {
            "in": "query",
            "name": "maxPrice",
            "schema": { "type": "number", "minimum": 0 },
            "description": "Filtra alojamientos con precio por noche menor al valor dado"
          }
        ],
        "responses": {
          "200": {
            "description": "Lista paginada de alojamientos",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/PaginatedAlojamientos" }
              }
            }
          },
          "204": { "description": "No hay alojamientos" }
        }
      },
      "post": {
        "summary": "Crear un alojamiento",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AlojamientoInput" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Alojamiento creado",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Alojamiento" }
              }
            }
          },
          "400": {
            "description": "Error de validación (Zod) o categoria inválida",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    { "$ref": "#/components/schemas/ZodIssues" },
                    { "$ref": "#/components/schemas/ErrorBadRequest" }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/alojamientos/{id}": {
      "get": {
        "summary": "Obtener un alojamiento por ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "integer" },
            "description": "ID numérico del alojamiento"
          }
        ],
        "responses": {
          "200": {
            "description": "Alojamiento encontrado",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Alojamiento" }
              }
            }
          },
          "404": {
            "description": "Alojamiento no existe",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorNotFound" }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorInternal" }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Eliminar un alojamiento por ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "Alojamiento eliminado",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Alojamiento" }
              }
            }
          },
          "404": {
            "description": "No existe el alojamiento con ese ID",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorNotFound" }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Actualizar un alojamiento por ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AlojamientoInput" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Alojamiento actualizado",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Alojamiento" }
              }
            }
          },
          "404": {
            "description": "No existe el alojamiento con ese ID",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorNotFound" }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Categoria": {
        "type": "string",
        "description": "Categoria del alojamiento",
        "enum": ["Hotel", "Departamento", "Cabana", "Apart"]
      },
      "Alojamiento": {
        "type": "object",
        "properties": {
          "id": { "type": "integer", "example": 1 },
          "nombre": { "type": "string", "example": "Gran Hotel" },
          "categoria": { "$ref": "#/components/schemas/Categoria" },
          "precioPorNoche": { "type": "number", "example": 120.5 },
          "reservas": {
            "type": "array",
            "items": { "type": "object" },
            "description": "Reservas asociadas (estructura no detallada)"
          },
            "caracteristicas": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Características adicionales"
          }
        },
        "required": ["id", "nombre", "categoria", "precioPorNoche"]
      },
      "AlojamientoInput": {
        "type": "object",
        "properties": {
          "nombre": { "type": "string", "minLength": 3, "maxLength": 20, "example": "Gran Hotel" },
          "categoria": { "$ref": "#/components/schemas/Categoria" },
          "precioPorNoche": { "type": "number", "minimum": 0, "example": 120.5 }
        },
        "required": ["nombre", "categoria", "precioPorNoche"]
      },
      "PaginatedAlojamientos": {
        "type": "object",
        "properties": {
          "pagina": { "type": "integer", "example": 1 },
          "perPage": { "type": "integer", "example": 10 },
          "total": { "type": "integer", "example": 42 },
          "totalPaginas": { "type": "integer", "example": 5 },
          "data": { "type": "array", "items": { "$ref": "#/components/schemas/Alojamiento" } }
        }
      },
      "ZodIssue": {
        "type": "object",
        "properties": {
          "code": { "type": "string", "example": "too_small" },
          "minimum": { "type": "integer", "example": 3 },
          "type": { "type": "string", "example": "string" },
          "inclusive": { "type": "boolean", "example": true },
          "message": { "type": "string", "example": "String must contain at least 3 character(s)" },
          "path": { "type": "array", "items": { "type": "string" } }
        },
        "required": ["code", "message"]
      },
      "ZodIssues": {
        "type": "array",
        "items": { "$ref": "#/components/schemas/ZodIssue" }
      },
      "ErrorBadRequest": {
        "type": "object",
        "description": "Datos inválidos o categoría incorrecta (400).",
        "properties": {
          "message": { "type": "string", "example": "Categoria invalida: Barco" }
        },
        "required": ["message"]
      },
      "ErrorNotFound": {
        "type": "object",
        "description": "Recurso no encontrado (404).",
        "properties": {
          "id": { "type": "integer", "example": 123 },
          "message": { "type": "string", "example": "No existe el alojamiento con id 123" }
        },
        "required": ["id", "message"]
      },
      "ErrorInternal": {
        "type": "object",
        "description": "Error interno del servidor (500).",
        "properties": {
          "error": { "type": "string", "example": "Ups. Algo sucedio en el servidor." }
        },
        "required": ["error"]
      }
    }
  }
}
